---
layout:     post
title:      Oracle—学习笔记#day02
subtitle:   Oracle
date:       2019-08-17
author:     DiCaprio
header-img: img/post-bg-keybord.jpg
catalog: true
tags:
    - Oracle
---

<p id="main-toc"><strong>目录</strong></p>


<p id="%E4%B8%80.%E8%A7%86%E5%9B%BE%5B%E5%BA%94%E7%94%A8%5D-toc" style="margin-left:0px;"><a href="#%E4%B8%80.%E8%A7%86%E5%9B%BE%5B%E5%BA%94%E7%94%A8%5D" rel="nofollow" data-token="e321186da4952fcf649c1b5c4c3c0147" target="_self">一.视图[应用]</a></p>
<p id="%E4%BA%8C.%E7%B4%A2%E5%BC%95%5B%E5%BA%94%E7%94%A8%5D-toc" style="margin-left:0px;"><a href="#%E4%BA%8C.%E7%B4%A2%E5%BC%95%5B%E5%BA%94%E7%94%A8%5D" rel="nofollow" data-token="1cdd095717e66b0b4611250bee18b474" target="_self">二.索引[应用]</a></p>
<p id="%E4%B8%89.pl%2Fsql%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%5B%E4%BA%86%E8%A7%A3%5D-toc" style="margin-left:0px;"><a href="#%E4%B8%89.pl%2Fsql%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%5B%E4%BA%86%E8%A7%A3%5D" rel="nofollow" data-token="4954089cceaba458b88acadac2051e3f" target="_self">三.pl/sql 基本语法[了解]</a></p>
<p id="1.pl%2Fsql%20%C2%A0%E7%A8%8B%E5%BA%8F%E8%AF%AD%E6%B3%95-toc" style="margin-left:40px;"><a href="#1.pl%2Fsql%20%C2%A0%E7%A8%8B%E5%BA%8F%E8%AF%AD%E6%B3%95" rel="nofollow" data-token="da3524f9dfa44f877a2a8a5cce0dec86" target="_self">1.pl/sql &nbsp;程序语法</a></p>
<p id="2.%E5%B8%B8%E9%87%8F%E5%92%8C%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89-toc" style="margin-left:40px;"><a href="#2.%E5%B8%B8%E9%87%8F%E5%92%8C%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89" rel="nofollow" data-token="074880dd2784ffe375ac337283252ca4" target="_self">2.常量和变量定义</a></p>
<p id="3.%20if%20%C2%A0%E5%88%86%E6%94%AF-toc" style="margin-left:40px;"><a href="#3.%20if%20%C2%A0%E5%88%86%E6%94%AF" rel="nofollow" data-token="accb30250704477aff1407b966029dd3" target="_self">3. if &nbsp;分支</a></p>
<p id="4.LOOP%C2%A0%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5-toc" style="margin-left:40px;"><a href="#4.LOOP%C2%A0%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5" rel="nofollow" data-token="f174b280a220b924daacacfdc1ead13f" target="_self">4.LOOP&nbsp;循环语句</a></p>
<p id="5.%20%E6%B8%B8%E6%A0%87%20Cursor-toc" style="margin-left:40px;"><a href="#5.%20%E6%B8%B8%E6%A0%87%20Cursor" rel="nofollow" data-token="450427aeb3296a850ccda5b63b7b86f2" target="_self">5. 游标 Cursor</a></p>
<p id="%E5%9B%9B.%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E7%90%86%E8%A7%A3%5D-toc" style="margin-left:40px;"><a href="#%E5%9B%9B.%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E7%90%86%E8%A7%A3%5D" rel="nofollow" data-token="0d442a4fb83b16abc4cf8a6992e71533" target="_self">四.存储过程[理解]</a></p>
<p id="%E4%BA%94.%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%5B%E7%90%86%E8%A7%A3%5D-toc" style="margin-left:0px;"><a href="#%E4%BA%94.%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%5B%E7%90%86%E8%A7%A3%5D" rel="nofollow" data-token="deb295e5f190aedb2bfb20d30fa6b348" target="_self">五.存储函数[理解]</a></p>
<p id="%E5%85%AD.%E8%A7%A6%E5%8F%91%E5%99%A8%5B%E7%90%86%E8%A7%A3%5D-toc" style="margin-left:0px;"><a href="#%E5%85%AD.%E8%A7%A6%E5%8F%91%E5%99%A8%5B%E7%90%86%E8%A7%A3%5D" rel="nofollow" data-token="3e64d36da9380885741e9d2a95826865" target="_self">六.触发器[理解]</a></p>
<p id="%E4%B8%83%EF%BC%8EJava%20%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E5%BA%94%E7%94%A8%5D-toc" style="margin-left:0px;"><a href="#%E4%B8%83%EF%BC%8EJava%20%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E5%BA%94%E7%94%A8%5D" rel="nofollow" data-token="01db30a0e61447f7e93719574327b6a3" target="_self">七．Java 程序调用存储过程[应用]</a></p>
<p id="1.java%20%C2%A0%E8%BF%9E%E6%8E%A5%20oracle%20%E7%9A%84%20jar%C2%A0-toc" style="margin-left:40px;"><a href="#1.java%20%C2%A0%E8%BF%9E%E6%8E%A5%20oracle%20%E7%9A%84%20jar%C2%A0" rel="nofollow" data-token="32cf333abaf991e2783abbd704c36b74" target="_self">1.java &nbsp;连接 oracle 的 jar&nbsp;</a></p>
<p id="2.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2-toc" style="margin-left:40px;"><a href="#2.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2" rel="nofollow" data-token="99b1eff3b1fea5ccc3f8215da887c001" target="_self">2.数据库连接字符串</a></p>
<p id="3.%E5%AE%9E%E7%8E%B0%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B0%83%E7%94%A8-toc" style="margin-left:40px;"><a href="#3.%E5%AE%9E%E7%8E%B0%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B0%83%E7%94%A8" rel="nofollow" data-token="5cf553a99015b781dbb1c78bb4f354b7" target="_self">3.实现存储过程的调用</a></p>
<p id="%E8%BF%87%E7%A8%8B%E5%AE%9A%E4%B9%89-toc" style="margin-left:80px;"><a href="#%E8%BF%87%E7%A8%8B%E5%AE%9A%E4%B9%89" rel="nofollow" data-token="ce013edb81a1a29762333db400dd7e33" target="_self">过程定义</a></p>
<p id="%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%88%E5%8C%85%E5%90%AB%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E3%80%81%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%88%E5%8C%85%E5%90%AB%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E3%80%81%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%EF%BC%89" rel="nofollow" data-token="5915abf3e094f1cf0992a8307782037f" target="_self">调用存储过程（包含存储过程、存储函数）</a></p>
<hr id="hr-toc"><h1 id="%E4%B8%80.%E8%A7%86%E5%9B%BE%5B%E5%BA%94%E7%94%A8%5D"><a name="t0"></a>一.视图[应用]</h1>

<blockquote>
<p>视图就是封装了一条复杂查询的语句。<br>
语法 1.：CREATE VIEW 视图名称 AS 子查询<br>
范例：建立一个视图，此视图包括了 20 部门的全部员工信息<br>
create view empvd20 as select * from emp t where t.deptno = 20<br>
视图创建完毕就可以使用视图来查询，查询出来的都是 20 部门的员工</p>
</blockquote>

<p><img alt="" class="has" height="170" src="https://img-blog.csdnimg.cn/20190817091616204.png" width="490"></p>
<blockquote>
<p>语法 2：CREATE OR REPLACE VIEW 视图名称 AS 子查询<br>
如果视图已经存在我们可以使用语法 2 来创建视图，这样已有的视图会被覆盖。<br>
create or replace view empvd20 as select * from emp t where t.deptno = 20<br>
那么视图可以修改吗？</p>
</blockquote>

<p><img alt="" class="has" height="169" src="https://img-blog.csdnimg.cn/20190817091637214.png" width="552"></p>
<p><img alt="" class="has" height="109" src="https://img-blog.csdnimg.cn/20190817091646764.png" width="562"></p>
<blockquote>
<p>我们尝试着修改视图但是发现是<strong>视图所查询的表的字段值被修改了</strong>。所以我们一般不会去修改视图。<br>
我们可以设置视图为<strong>只读</strong>。</p>
</blockquote>

<blockquote>
<p>语法 3：CREATE OR REPLACE VIEW 视图名称 AS 子查询 WITH READ ONLY<br>
create or replace view empvd20 as select * from emp t where t.deptno = 20 with readonly</p>
</blockquote>

<p><img alt="" class="has" height="162" src="https://img-blog.csdnimg.cn/20190817091752818.png" width="347"></p>
<p><img alt="" class="has" height="327" src="https://img-blog.csdnimg.cn/20190817100006301.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="593"></p>
<h1 id="%E4%BA%8C.%E7%B4%A2%E5%BC%95%5B%E5%BA%94%E7%94%A8%5D"><a name="t1"></a>二.索引[应用]</h1>
<blockquote>
<p>索引是用于<strong>加速数据存取的数据对象</strong>。<strong>合理的使用索引可以大大降低 i/o 次数,从而<br>
提高数据访问性能</strong>。索引有很多种我们主要介绍常用的几种:<br>
为什么添加了索引之后，会加快查询速度呢？<br>
图书馆：如果杂乱地放书的话检索起来就非常困难,所以将书分类，然后再建一个箱子，箱<br>
子里面放卡片，卡片里面可以按类查询,按书名查或者类别查,这样的话速度会快很多很多，<br>
这个就有点像索引。索引的好处就是提高你找到书的速度，但是正是因为你建了索引，就应该有人<br>
专门来维护索引，维护索引是要有时间精力的开销的，也就是说索引是不能乱建的，所以建索引有<br>
个原则：如果有一个字段如果不经常查询，就不要去建索引。现在把书变成我们的表，把卡片变成<br>
我们的索引，就知道为什么索引会快，为什么会有开销。<br>
创建索引的语法：<br><strong>创建索引：</strong><br><strong>1． 单列索引</strong><br>
单列索引是基于单个列所建立的索引，比如:<br>
CREATE index 索引名 on 表名(列名)<br><strong>2． 复合索引</strong><br>
复合索引是基于两个列或多个列的索引。在同一张表上可以有多个索引，但是<br>
要求列的组合必须不同,比如：<br>
Create index emp_idx1 on emp(ename,job);<br>
Create index emp_idx1 on emp(job,ename);<br>
范例：给 person 表的name建立索引<br>
create index pname_index on person(name);<br>
范例：给 person 表创建一个 name 和 gender 的索引<br>
create index pname_gender_index on person(name, gender);<br>
索引的使用原则：</p>

<ul><li>在大表上建立索引才有意义</li>
	<li>在 where子句后面或者是连接条件上的字段建立索引</li>
	<li>表中数据修改频率高时不建议建立索引</li>
</ul></blockquote>

<p><img alt="" class="has" height="314" src="https://img-blog.csdnimg.cn/20190817100019280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="603"></p>
<h1 id="%E4%B8%89.pl%2Fsql%20%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%5B%E4%BA%86%E8%A7%A3%5D"><a name="t2"></a>三.pl/sql 基本语法[了解]</h1>
<blockquote>
<p>什么是 PL/SQL?<br>
PL/SQL（Procedure Language/SQL）<br>
PLSQL 是<strong> Oracle 对sql 语言的过程化扩展</strong>，指在 SQL 命令语言中增加了过程处理语句（如分支、循环等），使 SQL语言具有过程处理能力。把SQL 语言的数据操纵能力与过程语言的数据处理能力结合起来，使得 PLSQL面向过程但比过程语言简单、高效、灵活和实用。<br>
范例 1：为职工涨工资，每人涨 10％的工资。<br>
update emp set sal=sal*1.1<br>
范例 2：例 2: 按职工的职称长工资,总裁涨 1000元,经理涨800 元，其他人员涨 400 元。<br>
这样的需求我们就无法使用一条 SQL来实现，需要借助其他程序来帮助完成，也可以使用 pl/sql。</p>
</blockquote>

<h2 id="1.pl%2Fsql%20%C2%A0%E7%A8%8B%E5%BA%8F%E8%AF%AD%E6%B3%95"><a name="t3"></a>1.pl/sql &nbsp;程序语法</h2>
<pre class="has" name="code"><code class="hljs sql"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">程序语法：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">declare</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">说明部分 （变量说明，游标申明，例外说明 〕</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语句序列 （DML 语句〕…</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">exception</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">例外处理语句</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">End</span>;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<h2 id="2.%E5%B8%B8%E9%87%8F%E5%92%8C%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89"><a name="t4"></a>2.常量和变量定义</h2>
<pre class="has" name="code"><code class="hljs vbnet"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">在程序的声明阶段可以来定义常量和变量。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  变量的基本类型就是 oracle 中的建表时字段的变量如 <span class="hljs-built_in">char</span>, varchar2, <span class="hljs-built_in">date</span>, number,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">boolean</span>, <span class="hljs-built_in">long</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">定义语法：varl <span class="hljs-built_in">char</span>(<span class="hljs-number">15</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">Psal number(<span class="hljs-number">9</span>,<span class="hljs-number">2</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">说明变量名、数据类型和长度后用分号结束说明语句。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">常量定义：married constant <span class="hljs-built_in">boolean</span>:=<span class="hljs-literal">true</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  引用变量</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">Myname emp.ename%type;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">引用型变量，即my_name 的类型与emp 表中 ename 列的类型一样</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">在 sql中使用 <span class="hljs-keyword">into</span> 来赋值</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">declare</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">emprec emp.ename%type;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">begin</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">select</span> t.ename <span class="hljs-keyword">into</span> emprec <span class="hljs-keyword">from</span> emp t <span class="hljs-keyword">where</span> t.empno = <span class="hljs-number">7369</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">dbms_output.put_line(emprec);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  记录型变量</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">Emprec emp%rowtype</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">记录变量分量的引用</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">emp_rec.ename:=<span class="hljs-comment">'ADAMS';</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">declare</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">p emp%rowtype;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">begin</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">into</span> p <span class="hljs-keyword">from</span> emp t <span class="hljs-keyword">where</span> t.empno = <span class="hljs-number">7369</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">dbms_output.put_line(p.ename || <span class="hljs-comment">' ' || p.sal);</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span>;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p><img alt="" class="has" height="362" src="https://img-blog.csdnimg.cn/20190817100119911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="627"></p>
<h2 id="3.%20if%20%C2%A0%E5%88%86%E6%94%AF"><a name="t5"></a>3. if &nbsp;分支</h2>
<pre class="has" name="code"><code class="hljs vbscript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">1</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">IF</span> 条件 <span class="hljs-keyword">THEN</span>  语句 <span class="hljs-number">1</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语句 <span class="hljs-number">2</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">2</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">IF</span> 条件 <span class="hljs-keyword">THEN</span> 语句序列 <span class="hljs-number">1</span> ；</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">ELSE</span> 语句序列 <span class="hljs-number">2</span> ；</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span> ；</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">3</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">IF</span> 条件 <span class="hljs-keyword">THEN</span>  语句;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">ELSIF 语句 <span class="hljs-keyword">THEN</span> 语句;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">ELSE</span> 语句;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p><img alt="" class="has" height="272" src="https://img-blog.csdnimg.cn/20190817100136561.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="367"></p>
<h2 id="4.LOOP%C2%A0%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><a name="t6"></a>4.LOOP&nbsp;循环语句</h2>
<pre class="has" name="code"><code class="hljs vbnet"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">1</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">WHILE</span> total &lt;= <span class="hljs-number">25000</span> <span class="hljs-keyword">LOOP</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">.. .</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">total : = total + salary;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">2</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">Loop</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">EXIT</span> [<span class="hljs-keyword">when</span> 条件];</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">……</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">End</span> <span class="hljs-keyword">loop</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法 <span class="hljs-number">3</span>：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">FOR</span> I <span class="hljs-keyword">IN</span> <span class="hljs-number">1</span> . . <span class="hljs-number">3</span> <span class="hljs-keyword">LOOP</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语句序列 ;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span> </div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p><img alt="" class="has" height="523" src="https://img-blog.csdnimg.cn/20190817100159936.png" width="291"></p>
<h2 id="5.%20%E6%B8%B8%E6%A0%87%20Cursor"><a name="t7"></a>5. 游标 Cursor</h2>
<blockquote>
<p>在写 java 程序中有集合的概念，那么在 pl/sql 中也会用到多条记录，这时候我们就要用到游标，游标可以存储查询返回的多条数据</p>
</blockquote>

<blockquote>
<p>语法：<br>
CURSOR 游标名 [ (参数名 数据类型,参数名 数据类型,...)] IS SELECT 语句;<br>
例如： cursor c1 is select ename from emp;<br>
游标的使用步骤：<br>
&nbsp; 打开游标： open c1; (打开游标执行查询)<br>
&nbsp; 取一行游标的值：fetch c1 into pjob; (取一行到变量中)<br>
&nbsp;关闭游标： close c1;(关闭游标释放资源)<br>
&nbsp;游标的结束方式 exit when c1%notfound<br>
&nbsp;注意： 上面的 pjob 必须与 emp表中的 job 列类型一致：<br>
定义：pjob emp.empjob%type;</p>
</blockquote>

<p><img alt="" class="has" height="581" src="https://img-blog.csdnimg.cn/20190817100226829.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="460"></p>
<h2 id="%E5%9B%9B.%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E7%90%86%E8%A7%A3%5D"><a name="t8"></a>四.存储过程[理解]</h2>
<blockquote>
<p>存储过程（Stored Procedure）是在大型数据库系统中，一组为了完成特定功能的 SQL 语句集，经编译后存储在数据库中，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。存储过程是数据库中的一个重要对象，任何一个设计良好的数据库应用程序都应该用到存储过程。</p>
</blockquote>

<pre class="has" name="code"><code class="hljs delphi"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">创建存储过程语法：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">create [<span class="hljs-keyword">or</span> replace] <span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span>  过程名[<span class="hljs-params">( 参数名 <span class="hljs-keyword">in</span>/<span class="hljs-keyword">out</span>  数据类型)</span>]</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">AS</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">PLSQL</span> 子程序体；</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">End</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">或者</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">create [<span class="hljs-keyword">or</span> replace] <span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span>  过程名[<span class="hljs-params">( 参数名 <span class="hljs-keyword">in</span>/<span class="hljs-keyword">out</span>  数据类型)</span>]</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">is</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">PLSQL</span> 子程序体；</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-title">End</span> 过程名;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p><img alt="" class="has" height="353" src="https://img-blog.csdnimg.cn/20190817100245963.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="635"></p>
<h1 id="%E4%BA%94.%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%5B%E7%90%86%E8%A7%A3%5D"><a name="t9"></a>五.存储函数[理解]</h1>
<pre class="has" name="code"><code class="hljs sql"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">function</span>  函数名(<span class="hljs-keyword">Name</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">type</span>, <span class="hljs-keyword">Name</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">type</span>, ...) <span class="hljs-keyword">return</span>  数据类型 <span class="hljs-keyword">is</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">结果变量  数据类型;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">return</span>( 结果变量);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span> 函数名;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<blockquote>
<p><strong>存储过程和存储函数的区别</strong><br>
一般来讲，过程和函数的区别在于函数可以有一个返回值；而过程没有返回值。<br>
但过程和函数都可以通过 out 指定一个或多个输出参数。我们可以利用out 参数，在过程和函数中实现返回多个值。</p>
</blockquote>

<p><img alt="" class="has" height="693" src="https://img-blog.csdnimg.cn/20190817100338294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="711"></p>
<p><img alt="" class="has" height="576" src="https://img-blog.csdnimg.cn/20190817100403418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="821"></p>
<h1 id="%E5%85%AD.%E8%A7%A6%E5%8F%91%E5%99%A8%5B%E7%90%86%E8%A7%A3%5D"><a name="t10"></a>六.触发器[理解]</h1>
<blockquote>
<p>数据库触发器是一个与表相关联的、存储的 PL/SQL 程序。每当一个特定的数据操作语句(Insert,update,delete)在指定的表上发出时，Oracle 自动地执行触发器中定义的语句序列。</p>

<p>触发器可用于<br>
&nbsp; 数据确认<br>
&nbsp; 实施复杂的安全性检查<br>
&nbsp; 做审计，跟踪表上所做的数据操作等<br>
&nbsp; 数据的备份和同步</p>
</blockquote>

<pre class="has" name="code"><code class="hljs sql"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">触发器的类型</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语句级触发器 ：在指定的操作语句操作之前或之后执行一次，不管这条语句影响 </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">了多少行 。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">行级触发器（FOR EACH ROW） ：触发语句作用的每一条记录都被触发。在行级触 </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">发器中使用 old 和 new伪记录变量, 识别值的状态。</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">语法：</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">or</span> <span class="hljs-keyword">REPLACE</span>] <span class="hljs-keyword">TRIGGER</span> 触发器名</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">{<span class="hljs-keyword">BEFORE</span> | <span class="hljs-keyword">AFTER</span>}</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">{<span class="hljs-keyword">DELETE</span> | <span class="hljs-keyword">INSERT</span> | <span class="hljs-keyword">UPDATE</span> [<span class="hljs-keyword">OF</span>  列名]}</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">ON</span> 表名</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">[<span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span> [<span class="hljs-keyword">WHEN</span>( 条件) ] ]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">PLSQL  块</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">End</span>  触发器名</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p><img alt="" class="has" height="744" src="https://img-blog.csdnimg.cn/20190817100440120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="587"></p>
<p><img alt="" class="has" height="369" src="https://img-blog.csdnimg.cn/20190817100514723.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="480"></p>
<h1 id="%E4%B8%83%EF%BC%8EJava%20%E7%A8%8B%E5%BA%8F%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%5B%E5%BA%94%E7%94%A8%5D"><a name="t11"></a>七．Java 程序调用存储过程[应用]</h1>
<h2 id="1.java%20%C2%A0%E8%BF%9E%E6%8E%A5%20oracle%20%E7%9A%84%20jar%C2%A0"><a name="t12"></a>1.java &nbsp;连接 oracle 的 jar&nbsp;</h2>
<p><img alt="" class="has" height="40" src="https://img-blog.csdnimg.cn/20190817100624911.png" width="264"></p>
<p>ojdbc14.jar</p>
<p><img alt="" class="has" height="77" src="https://img-blog.csdnimg.cn/20190817093233194.png" width="357"></p>
<p><img alt="" class="has" height="374" src="https://img-blog.csdnimg.cn/20190817101035935.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="377"></p>
<h2 id="2.%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><a name="t13"></a>2.数据库连接字符串</h2>
<pre class="has" name="code"><code class="hljs vbscript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">String</span> driver=<span class="hljs-string">"oracle.jdbc.OracleDriver"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">String</span> url=<span class="hljs-string">"jdbc:oracle:thin:@192.168.56.10:1521:orcl"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">String</span> username=<span class="hljs-string">"scott"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">String</span> password=<span class="hljs-string">"tiger"</span>;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<p>测试代码：</p>
<p><img alt="" class="has" height="377" src="https://img-blog.csdnimg.cn/20190817093327254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2OTEwNjM0,size_16,color_FFFFFF,t_70" width="681"></p>
<h2 id="3.%E5%AE%9E%E7%8E%B0%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B0%83%E7%94%A8"><a name="t14"></a>3.实现存储过程的调用</h2>
<h3 id="%E8%BF%87%E7%A8%8B%E5%AE%9A%E4%B9%89"><a name="t15"></a><strong>过程定义</strong></h3>
<pre class="has" name="code"><code class="hljs sql"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-comment">-- 统计年薪的过程</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">create</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">replace</span> <span class="hljs-keyword">procedure</span> proc_countyearsal(eno <span class="hljs-keyword">in</span> <span class="hljs-built_in">number</span>,esal</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">out</span> <span class="hljs-built_in">number</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">as</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">select</span> sal*<span class="hljs-number">12</span>+nvl(comm,<span class="hljs-number">0</span>) <span class="hljs-keyword">into</span> esal <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> empno=eno;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-comment">-- 调用</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">declare</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">esal <span class="hljs-built_in">number</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">begin</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">proc_countyearsal(<span class="hljs-number">7839</span>,esal);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">dbms_output.put_line(esal);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">end</span>;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>
<h3 id="%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%88%E5%8C%85%E5%90%AB%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E3%80%81%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%EF%BC%89"><a name="t16"></a><strong>调用存储过程（包含存储过程、存储函数）</strong></h3>
<pre class="has" name="code"><code class="hljs perl"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">@Test</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">public void testProcedure01(){</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    String driver=<span class="hljs-string">"oracle.jdbc.OracleDriver"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    String url=<span class="hljs-string">"jdbc:oracle:thin:@192.168.56.10:1521:orcl"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    String username=<span class="hljs-string">"scott"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    String password=<span class="hljs-string">"tiger"</span>;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    try {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        Class.forName(driver);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        Connection con = DriverManager.getConnection(url,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        username, password);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        CallableStatement  callSt  =  con.prepareCall(<span class="hljs-string"><span class="hljs-string">"{call</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">        proc_countyearsal(?,?)}"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        callSt.setInt(<span class="hljs-number">1</span>, <span class="hljs-number">7839</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        callSt.registerOutParameter(<span class="hljs-number">2</span>, OracleTypes.NUMBER);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        callSt.execute();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        System.out.println(callSt.getObject(<span class="hljs-number">2</span>));</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    } catch (Exception e) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    e.printStackTrace();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">}</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre>